"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[153],{153:(b,_,n)=>{n.d(_,{x:()=>U});var a=n(9085),e=n(2223),g=n(3144),p=n(2980),f=n(8572),O=n(5775),d=n(4755),l=n(9401),c=n(1299),m=n(1217),E=n(1728),v=n(9114),y=n(8097),C=n(787);const S=["orderInput"];function D(i,h){1&i&&(e.TgZ(0,"div",20),e._UZ(1,"div",21),e.qZA())}function M(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"mat-option",22),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.orderOption(s))}),e._uU(1),e.qZA()}if(2&i){const t=h.$implicit;e.Q6J("value",t),e.xp6(1),e.HOy("",t.data.orderId," / ",t.data.clientName?t.data.clientName:t.data.company," / ",t.data.startDate," / ",t.data.place,"")}}function T(i,h){1&i&&(e.TgZ(0,"div",20),e._UZ(1,"div",21),e.qZA())}let U=(()=>{class i{constructor(t,r,o,s,u){this.http=t,this.authenticationService=r,this.orderDataService=o,this.router=s,this.ocultarSidebarService=u,this.orders=[],this.foundOrder=null,this.loading=!1,this.shouldReload=!1,this.router.events.subscribe(I=>{I instanceof a.m2&&this.shouldReload&&(window.location.reload(),this.shouldReload=!1)})}ngOnInit(){this.ocultarSidebarService.ocultarSidebar(),this.data=this.authenticationService.getData();const t=localStorage.getItem("currentUserData");if(t?this.data=JSON.parse(t):(this.data=this.authenticationService.getData(),localStorage.setItem("currentUserData",JSON.stringify(this.data))),console.log("Datos en storedUserData desde el SearchOrder: ",t),"Client"==this.data.role)this.getOrderByIdUser(this.data.email,this.data.hkId),this.getSearchOrders(),console.log("Orden por usuario: ",this.getOrderByIdUser(this.data.email,this.data.hkId));else if("Administrator"==this.data.role||"Executive"==this.data.role){const r=sessionStorage.getItem("currentOrders");r?(this.orders=JSON.parse(r),console.log("\xd3rdenes recuperadas desde sessionStorage: ",this.orders)):(this.getOrders(),this.getSearchOrders())}else"Supervisor"==this.data.role?(this.getOrdersBySupervisor(this.data.email),this.getSearchOrdersBySuperv(this.data.email)):"Employee"==this.data.role&&(this.getOrderByHKid(this.data.highkeyId),this.getSearchOrdersByEmp(this.data.highkeyId));console.log("Datos usuario: ",this.data)}getOrders(){fetch("https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrders").then(t=>t.json()).then(t=>{this.orders=t,this.orders.sort((r,o)=>o.data.ordNumb-r.data.ordNumb),sessionStorage.setItem("currentOrders",JSON.stringify(this.orders))}).catch(t=>{console.log(t)})}getOrderByHKid(t){t&&fetch(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?hkId=${t}`).then(r=>r.json()).then(r=>{console.log("Datos de la orden por usuario con highKey: ",r),this.orders=r,this.orders.sort((o,s)=>s.data.ordNumb-o.data.ordNumb)}).catch(r=>{console.log(r)})}getOrderByIdUser(t,r){r?fetch(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?hkId=${r}`).then(o=>o.json()).then(o=>{console.log("Datos de la orden por usuario con highKey: ",o),this.orders=o,this.orders.sort((s,u)=>u.data.ordNumb-s.data.ordNumb)}).catch(o=>{console.log(o)}):fetch(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?email=${t}`).then(o=>o.json()).then(o=>{console.log("Datos de la orden por usuario por email: ",o),this.orders=o,this.orders.sort((s,u)=>u.data.ordNumb-s.data.ordNumb)}).catch(o=>{console.log(o)})}getOrdersBySupervisor(t){t&&fetch(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByUser/user?user=${t}`).then(r=>r.json()).then(r=>{console.log("Datos de la orden por supervisor: ",r),this.orders=r,this.orders.sort((o,s)=>s.data.ordNumb-o.data.ordNumb)}).catch(r=>{console.log(r)})}orderOption(t){this.selectedOrder=t,this.orderDataService.setSelectedOrder(t)}onOrderSelection(t){this.selectedOrder=t}navegar(){"Administrator"===this.data.role||"Supervisor"===this.data.role||"Client"===this.data.role?this.router.navigate(["/admin/dashboard-lm/"]):"Employee"===this.data.role&&this.router.navigate(["/admin/employees/admin-employees/"]),this.loading=!0,setTimeout(()=>{this.shouldReload=!0},200)}getSearchOrders(){this.http.get("https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrders").subscribe(r=>{this.ordenes=r})}getSearchOrdersByEmp(t){this.http.get(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?hkId=${t}`).subscribe(o=>{this.ordenes=o})}getSearchOrdersBySuperv(t){this.http.get(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByUser/user?user=${t}`).subscribe(o=>{this.ordenes=o})}getSearchOrdersByEmp1(t){this.http.get(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?hkId=${t}`).subscribe(o=>{this.ordenes=o})}searchOrder(){let t=this.orderNumber;t=t.replace(/-/g,""),t.length>=4&&(t=t.substring(0,4)+"-"+t.substring(4)),this.orderNumber=t,this.foundOrder=null;for(const r of this.ordenes)if(r.data.orderId===this.orderNumber){this.foundOrder=r;break}this.foundOrder?this.orderDataService.setSelectedOrder(this.foundOrder):console.log("No se encontr\xf3 ning\xfan objeto con el orderId especificado.")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.eN),e.Y36(p.$),e.Y36(f.U),e.Y36(a.F0),e.Y36(O.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-search-order"]],viewQuery:function(t,r){if(1&t&&e.Gf(S,5),2&t){let o;e.iGM(o=e.CRH())&&(r.orderInput=o.first)}},decls:33,vars:8,consts:[[1,"content"],["class","loading-overlay",4,"ngIf"],[1,"container","marginContainer",2,"margin-left","10px"],[1,"block-header",2,"margin-top","70px"],[3,"title","active_item"],[1,"row",2,"margin-top","130px"],[1,"col-sm-12","col-md-7","col-lg-7"],[1,"form-label"],[2,"display","inline"],[3,"value","valueChange","selectionChange"],[3,"value","click",4,"ngFor","ngForOf"],[1,"row"],[1,"col-sm-12","col-md-6"],[1,"col-sm-12","col-md-6","col-lg-6",2,"display","inline-flex","width","30%"],["matInput","",3,"ngModel","ngModelChange"],["orderInput",""],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"ocultarImg","col-md-5","col-lg-5",2,"text-align","center"],["src","assets/images/search-order.png","alt","",2,"height","300px"],[2,"color","#414244"],[1,"loading-overlay"],[1,"loading-spinner"],[3,"value","click"]],template:function(t,r){1&t&&(e.TgZ(0,"section",0),e.YNc(1,D,2,0,"div",1),e.TgZ(2,"div",2)(3,"div",3),e._UZ(4,"app-breadcrumb",4),e.qZA(),e.TgZ(5,"div",5)(6,"div",6)(7,"div")(8,"label",7),e._uU(9,"List of orders"),e.qZA()(),e.TgZ(10,"mat-form-field",8)(11,"mat-label"),e._uU(12,"Select"),e.qZA(),e.TgZ(13,"mat-select",9),e.NdJ("valueChange",function(s){return r.selectedOrder=s})("selectionChange",function(s){return r.onOrderSelection(s.value)}),e.YNc(14,M,2,5,"mat-option",10),e.qZA()(),e.TgZ(15,"div",11)(16,"div",12)(17,"label",7),e._uU(18,"Order number"),e.qZA()(),e.TgZ(19,"div")(20,"mat-form-field",13)(21,"mat-label"),e._uU(22,"Input"),e.qZA(),e.TgZ(23,"input",14,15),e.NdJ("ngModelChange",function(s){return r.orderNumber=s})("ngModelChange",function(){return r.searchOrder()}),e.qZA()()()(),e.TgZ(25,"div")(26,"button",16),e.NdJ("click",function(){return r.navegar()}),e._uU(27,"Search"),e.qZA()()(),e.TgZ(28,"div",17),e._UZ(29,"img",18),e.qZA(),e.TgZ(30,"p",19),e._uU(31,"You will only be able to view the open orders in which you are a supervisor."),e.qZA()()()(),e.YNc(32,T,2,0,"div",1)),2&t&&(e.xp6(1),e.Q6J("ngIf",r.loading),e.xp6(3),e.Q6J("title","Search Order")("active_item","Search order"),e.xp6(9),e.Q6J("value",r.selectedOrder),e.xp6(1),e.Q6J("ngForOf",r.orders),e.xp6(9),e.Q6J("ngModel",r.orderNumber),e.xp6(3),e.Q6J("disabled",!(r.selectedOrder||r.foundOrder)),e.xp6(6),e.Q6J("ngIf",r.loading))},dependencies:[d.sg,d.O5,l.Fj,l.JJ,l.On,c.L,m.ey,E.lW,v.KE,v.hX,y.Nt,C.gD],styles:['@charset "UTF-8";.label-form[_ngcontent-%COMP%]{font-size:20px}@media (max-width: 576px){.ocultarImg[_ngcontent-%COMP%]{display:none}.marginContainer[_ngcontent-%COMP%]{margin-left:20px!important;padding-left:5px!important;padding-right:5px!important;width:90%}}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.8);display:flex;justify-content:center;align-items:center;z-index:999}.loading-spinner[_ngcontent-%COMP%]{border:4px solid rgba(0,0,0,.3);border-top:4px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']}),i})()},1299:(b,_,n)=>{n.d(_,{L:()=>O});var a=n(2223),e=n(4755),g=n(9085),p=n(1676);function f(d,l){if(1&d&&(a.TgZ(0,"li",11),a._uU(1),a.qZA()),2&d){const c=l.$implicit;a.xp6(1),a.Oqu(c)}}let O=(()=>{class d{constructor(){}}return d.\u0275fac=function(c){return new(c||d)},d.\u0275cmp=a.Xpm({type:d,selectors:[["app-breadcrumb"]],inputs:{title:"title",items:"items",active_item:"active_item"},decls:14,vars:7,consts:[[1,"breadcrumb-main"],[1,"row"],[1,"col-6"],[1,"breadcrumb-title"],[1,"page-title"],[1,"breadcrumb-list"],[1,"breadcrumb-item","bcrumb-1"],[3,"routerLink"],[3,"icon"],["class","breadcrumb-item",4,"ngFor","ngForOf"],[1,"breadcrumb-item","active"],[1,"breadcrumb-item"]],template:function(c,m){1&c&&(a.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),a._uU(5),a.qZA()()(),a.TgZ(6,"div",2)(7,"ul",5)(8,"li",6)(9,"a",7),a._UZ(10,"app-feather-icons",8),a.qZA()(),a.YNc(11,f,2,1,"li",9),a.TgZ(12,"li",10),a._uU(13),a.qZA()()()()()),2&c&&(a.xp6(5),a.Oqu(m.title),a.xp6(4),a.Q6J("routerLink","/admin/search-order"),a.xp6(1),a.Tol("breadcrumb-icon"),a.Q6J("icon","home"),a.xp6(1),a.Q6J("ngForOf",m.items),a.xp6(2),a.Oqu(m.active_item))},dependencies:[e.sg,g.rH,p.A]}),d})()}}]);