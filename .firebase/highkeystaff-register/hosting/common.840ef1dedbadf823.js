"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[8592],{153:(P,v,a)=>{a.d(v,{x:()=>z});var g=a(9085),t=a(2223),f=a(3144),O=a(2980),d=a(8572),p=a(5775),o=a(4755),c=a(9401),_=a(1299),C=a(1217),S=a(1728),E=a(9114),D=a(8097),L=a(787);const T=["orderInput"];function b(n,s){1&n&&(t.TgZ(0,"div",20),t._UZ(1,"div",21),t.qZA())}function U(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-option",22),t.NdJ("click",function(){const h=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.orderOption(h))}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.HOy("",e.data.orderId," / ",e.data.clientName?e.data.clientName:e.data.company," / ",e.data.startDate," / ",e.data.place,"")}}let z=(()=>{class n{constructor(e,i,r,h,l){this.http=e,this.authenticationService=i,this.orderDataService=r,this.router=h,this.ocultarSidebarService=l,this.orders=[],this.foundOrder=null,this.loading=!1,this.shouldReload=!1,this.router.events.subscribe(y=>{y instanceof g.m2&&this.shouldReload&&(window.location.reload(),this.shouldReload=!1)})}ngOnInit(){this.ocultarSidebarService.ocultarSidebar(),this.data=this.authenticationService.getData();const e=localStorage.getItem("currentUserData");e?this.data=JSON.parse(e):(this.data=this.authenticationService.getData(),localStorage.setItem("currentUserData",JSON.stringify(this.data))),console.log("Datos en storedUserData desde el SearchOrder: ",e),"Client"==this.data.role||("Administrator"==this.data.role||"Executive"==this.data.role?(this.getOrders(),this.getSearchOrders()):"Supervisor"==this.data.role?(console.log("thiis.data",this.data),this.getOrderByIdUser(this.data.email,this.data.hkId)):"Employee"==this.data.role&&(this.getOrderByIdUser(this.data.email,this.data.hkId),console.log("Orden por usuario: ",this.getOrderByIdUser(this.data.email,this.data.hkId)))),console.log("Datos usuario: ",this.data)}getOrders(){fetch("https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrders").then(e=>e.json()).then(e=>{this.orders=e,this.orders.sort((i,r)=>r.data.ordNum-i.data.ordNum)}).catch(e=>{console.log(e)})}getOrderByIdUser(e,i){i?fetch(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?hkId=${i}`).then(r=>r.json()).then(r=>{console.log("Datos de la orden por usuario con highKey: ",r),this.orders=r,this.orders.sort((h,l)=>l.data.ordNum-h.data.ordNum)}).catch(r=>{console.log(r)}):e&&fetch(`https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrdersByEmployee?email=${e}`).then(r=>r.json()).then(r=>{console.log("Datos de la orden por usuario por email: ",r),this.orders=r,this.orders.sort((h,l)=>l.data.ordNum-h.data.ordNum)}).catch(r=>{console.log(r)})}orderOption(e){this.selectedOrder=e,this.orderDataService.setSelectedOrder(e)}onOrderSelection(e){this.selectedOrder=e}navegar(){"Administrator"===this.data.role?this.router.navigate(["/admin/dashboard-lm/"]):"Employee"===this.data.role&&this.router.navigate(["/admin/employees/admin-employees/"]),this.loading=!0,setTimeout(()=>{this.shouldReload=!0},200)}getSearchOrders(){this.http.get("https://us-central1-highkeystaff.cloudfunctions.net/orders/getOrders").subscribe(i=>{this.ordenes=i})}searchOrder(){let e=this.orderNumber;e=e.replace(/-/g,""),e.length>=4&&(e=e.substring(0,4)+"-"+e.substring(4)),this.orderNumber=e,this.foundOrder=null;for(const i of this.ordenes)if(i.data.orderId===this.orderNumber){this.foundOrder=i;break}this.foundOrder?this.orderDataService.setSelectedOrder(this.foundOrder):console.log("No se encontr\xf3 ning\xfan objeto con el orderId especificado.")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.eN),t.Y36(O.$),t.Y36(d.U),t.Y36(g.F0),t.Y36(p.S))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-search-order"]],viewQuery:function(e,i){if(1&e&&t.Gf(T,5),2&e){let r;t.iGM(r=t.CRH())&&(i.orderInput=r.first)}},decls:32,vars:7,consts:[[1,"content"],["class","loading-overlay",4,"ngIf"],[1,"container","marginContainer",2,"margin-left","10px"],[1,"block-header",2,"margin-top","70px"],[3,"title","active_item"],[1,"row",2,"margin-top","130px"],[1,"col-sm-12","col-md-7","col-lg-7"],[1,"form-label"],[2,"display","inline"],[3,"value","valueChange","selectionChange"],[3,"value","click",4,"ngFor","ngForOf"],[1,"row"],[1,"col-sm-12","col-md-6"],[1,"col-sm-12","col-md-6","col-lg-6",2,"display","inline-flex","width","30%"],["matInput","",3,"ngModel","ngModelChange"],["orderInput",""],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"ocultarImg","col-md-5","col-lg-5",2,"text-align","center"],["src","assets/images/search-order.png","alt","",2,"height","300px"],[2,"color","#414244"],[1,"loading-overlay"],[1,"loading-spinner"],[3,"value","click"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0),t.YNc(1,b,2,0,"div",1),t.TgZ(2,"div",2)(3,"div",3),t._UZ(4,"app-breadcrumb",4),t.qZA(),t.TgZ(5,"div",5)(6,"div",6)(7,"div")(8,"label",7),t._uU(9,"List of orders"),t.qZA()(),t.TgZ(10,"mat-form-field",8)(11,"mat-label"),t._uU(12,"Select"),t.qZA(),t.TgZ(13,"mat-select",9),t.NdJ("valueChange",function(h){return i.selectedOrder=h})("selectionChange",function(h){return i.onOrderSelection(h.value)}),t.YNc(14,U,2,5,"mat-option",10),t.qZA()(),t.TgZ(15,"div",11)(16,"div",12)(17,"label",7),t._uU(18,"Order number"),t.qZA()(),t.TgZ(19,"div")(20,"mat-form-field",13)(21,"mat-label"),t._uU(22,"Input"),t.qZA(),t.TgZ(23,"input",14,15),t.NdJ("ngModelChange",function(h){return i.orderNumber=h})("ngModelChange",function(){return i.searchOrder()}),t.qZA()()()(),t.TgZ(25,"div")(26,"button",16),t.NdJ("click",function(){return i.navegar()}),t._uU(27,"Search"),t.qZA()()(),t.TgZ(28,"div",17),t._UZ(29,"img",18),t.qZA(),t.TgZ(30,"p",19),t._uU(31,"You will only be able to view the open orders in which you are a supervisor."),t.qZA()()()()),2&e&&(t.xp6(1),t.Q6J("ngIf",i.loading),t.xp6(3),t.Q6J("title","Search Order")("active_item","Search order"),t.xp6(9),t.Q6J("value",i.selectedOrder),t.xp6(1),t.Q6J("ngForOf",i.orders),t.xp6(9),t.Q6J("ngModel",i.orderNumber),t.xp6(3),t.Q6J("disabled",!(i.selectedOrder||i.foundOrder)))},dependencies:[o.sg,o.O5,c.Fj,c.JJ,c.On,_.L,C.ey,S.lW,E.KE,E.hX,D.Nt,L.gD],styles:['@charset "UTF-8";.label-form[_ngcontent-%COMP%]{font-size:20px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.8);display:flex;justify-content:center;align-items:center;z-index:999}.loading-spinner[_ngcontent-%COMP%]{border:4px solid rgba(0,0,0,.3);border-top:4px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 576px){.ocultarImg[_ngcontent-%COMP%]{display:none}.marginContainer[_ngcontent-%COMP%]{margin-left:20px!important;padding-left:5px!important;padding-right:5px!important;width:90%}}']}),n})()},7082:(P,v,a)=>{a.d(v,{Y:()=>O});var g=a(9401),t=a(2223),f=a(1728);let O=(()=>{class d{emitFiles(o){const c=o&&o.item(0);this.onChange(c),this.file=c}constructor(o){this.host=o,this.file=null}writeValue(o){this.host.nativeElement.value="",this.file=null}registerOnChange(o){this.onChange=o}registerOnTouched(o){}}return d.\u0275fac=function(o){return new(o||d)(t.Y36(t.SBq))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-file-upload"]],hostBindings:function(o,c){1&o&&t.NdJ("change",function(C){return c.emitFiles(C.target.files)})},features:[t._Bn([{provide:g.JU,useExisting:d,multi:!0}])],decls:6,vars:1,consts:[[1,"file-drop-area"],["mat-raised-button","","color","primary"],["type","file",1,"file-input"]],template:function(o,c){1&o&&(t.TgZ(0,"div",0)(1,"button",1),t._uU(2,"Choose file"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA(),t._UZ(5,"input",2),t.qZA()),2&o&&(t.xp6(4),t.Oqu(c.file?c.file.name:" or drag and drop file here"))},dependencies:[f.lW],styles:[".file-drop-area[_ngcontent-%COMP%]{border:1px dashed #7c7db3;border-radius:3px;position:relative;max-width:100%;margin-top:5px;padding:26px 20px 30px;transition:.2s}.file-input[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100%;width:100%;cursor:pointer;opacity:0}.file-msg[_ngcontent-%COMP%]{display:inline-block;margin-left:5px;font-size:12px;font-weight:500;color:#5b5bff}"]}),d})()},2054:(P,v,a)=>{a.d(v,{_w:()=>U,Ns:()=>z});var g=a(5861),t=a(2223),f=a(4707),O=a(727),d=a(7579),p=a(4986),o=a(9751),c=a(4482),_=a(5403),C=a(8421),E=a(5963);var L=a(3900);class T{constructor(){this.subject=new f.t(1),this.subscriptions=new O.w0}doFilter(s){this.subject.next(s)}dispose(){this.subscriptions.unsubscribe()}notEmpty(s,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[s]){const r=i[s].currentValue;null!=r&&e(r)}}))}has(s,e){this.subscriptions.add(this.subject.subscribe(i=>{i[s]&&e(i[s].currentValue)}))}notFirst(s,e){this.subscriptions.add(this.subject.subscribe(i=>{i[s]&&!i[s].isFirstChange()&&e(i[s].currentValue)}))}notFirstAndEmpty(s,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[s]&&!i[s].isFirstChange()){const r=i[s].currentValue;null!=r&&e(r)}}))}}const b=new t.OlP("NGX_ECHARTS_CONFIG");let U=(()=>{class n{constructor(e,i,r){this.el=i,this.ngZone=r,this.options=null,this.theme=null,this.initOpts=null,this.merge=null,this.autoResize=!0,this.loading=!1,this.loadingType="default",this.loadingOpts=null,this.chartInit=new t.vpe,this.optionsError=new t.vpe,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartPieSelectChanged=this.createLazyEvent("pieselectchanged"),this.chartPieSelected=this.createLazyEvent("pieselected"),this.chartPieUnselected=this.createLazyEvent("pieunselected"),this.chartMapSelectChanged=this.createLazyEvent("mapselectchanged"),this.chartMapSelected=this.createLazyEvent("mapselected"),this.chartMapUnselected=this.createLazyEvent("mapunselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartFocusNodeAdjacency=this.createLazyEvent("focusnodeadjacency"),this.chartUnfocusNodeAdjacency=this.createLazyEvent("unfocusnodeadjacency"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.chart$=new f.t(1),this.resize$=new d.x,this.changeFilter=new T,this.echarts=e.echarts}ngOnChanges(e){this.changeFilter.doFilter(e)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(function D(n,s=p.z,e){const i=(0,E.H)(n,s);return function S(n,s){return(0,c.e)((e,i)=>{const{leading:r=!0,trailing:h=!1}=s??{};let l=!1,y=null,u=null,M=!1;const I=()=>{u?.unsubscribe(),u=null,h&&(x(),M&&i.complete())},F=()=>{u=null,M&&i.complete()},A=m=>u=(0,C.Xf)(n(m)).subscribe((0,_.x)(i,I,F)),x=()=>{if(l){l=!1;const m=y;y=null,i.next(m),!M&&A(m)}};e.subscribe((0,_.x)(i,m=>{l=!0,y=m,(!u||u.closed)&&(r?x():A(m))},()=>{M=!0,(!(h&&l&&u)||u.closed)&&i.complete()}))})}(()=>i,e)}(100,p.z,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(()=>{this.animationFrameID=window.requestAnimationFrame(()=>this.resize$.next())})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",e=>this.onOptionsChange(e)),this.changeFilter.notFirstAndEmpty("merge",e=>this.setOption(e)),this.changeFilter.has("loading",e=>this.toggleLoading(!!e)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(e){this.chart?e?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(i=>e?i.showLoading(this.loadingType,this.loadingOpts):i.hideLoading())}setOption(e,i){if(this.chart)try{this.chart.setOption(e,i)}catch(r){console.error(r),this.optionsError.emit(r)}}refreshChart(){var e=this;return(0,g.Z)(function*(){e.dispose(),yield e.initChart()})()}createChart(){const e=this.el.nativeElement;if(window&&window.getComputedStyle){const i=window.getComputedStyle(e,null).getPropertyValue("height");(!i||"0px"===i)&&(!e.style.height||"0px"===e.style.height)&&(e.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:r})=>r(e,this.theme,this.initOpts)))}initChart(){var e=this;return(0,g.Z)(function*(){yield e.onOptionsChange(e.options),e.merge&&e.chart&&e.setOption(e.merge)})()}onOptionsChange(e){var i=this;return(0,g.Z)(function*(){e&&(i.chart||(i.chart=yield i.createChart(),i.chart$.next(i.chart),i.chartInit.emit(i.chart)),i.setOption(i.options,!0))})()}createLazyEvent(e){return this.chartInit.pipe((0,L.w)(i=>new o.y(r=>(i.on(e,h=>this.ngZone.run(()=>r.next(h))),()=>{this.chart&&(this.chart.isDisposed()||i.off(e))}))))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b),t.Y36(t.SBq),t.Y36(t.R0b))},n.\u0275dir=t.lG2({type:n,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loading:"loading",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartPieSelectChanged:"chartPieSelectChanged",chartPieSelected:"chartPieSelected",chartPieUnselected:"chartPieUnselected",chartMapSelectChanged:"chartMapSelectChanged",chartMapSelected:"chartMapSelected",chartMapUnselected:"chartMapUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartFocusNodeAdjacency:"chartFocusNodeAdjacency",chartUnfocusNodeAdjacency:"chartUnfocusNodeAdjacency",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[t.TTD]}),n})(),z=(()=>{class n{static forRoot(e){return{ngModule:n,providers:[{provide:b,useValue:e}]}}static forChild(){return{ngModule:n}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({}),n})()}}]);